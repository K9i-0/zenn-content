---
title: "Github Actionsã§ã®Flutterã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é«˜é€ŸåŒ–ã™ã‚‹"
emoji: "ğŸ™"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Github", "Flutter"]
published: true
---
Github Actionsã§Flutterã‚’ä½¿ã£ãŸWorkflowã‚’æ›¸ãã¨ãã«ä½¿ãˆã‚‹è£æŠ€ï¼Ÿã®ç´¹ä»‹ã§ã™ã€‚
å…·ä½“çš„ã«ã¯Flutterã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒ4ç§’ãã‚‰ã„ã§çµ‚ã‚ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

# å°å…¥æ–¹æ³•
Flutterã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«subosito/flutter-actionã‚’ä½¿ã£ã¦ã‚‹å ´åˆã€Flutterã‚’Githubã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§1åˆ†è¿‘ãé«˜é€ŸåŒ–ã§ãã¾ã™ã€‚
1. Flutterã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç”¨ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
[å‚è€ƒ(å…ƒãƒã‚¿)](https://github.com/FirebaseExtended/flutterfire/blob/master/.github/workflows/scripts/install-flutter.sh)
```bash:.github/workflows/scripts/install-flutter.sh
#!/bin/bash

BRANCH=$1
git clone https://github.com/flutter/flutter.git --depth 1 -b $BRANCH "$GITHUB_WORKSPACE/_flutter"
echo "$GITHUB_WORKSPACE/_flutter/bin" >> $GITHUB_PATH
```
2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
```
chmod +x .github/workflows/scripts/install-flutter.sh
```
3. subosito/flutter-actionã¨ç½®ãæ›ãˆã‚‹
```diff:.github/workflows/hoge.yaml
- - uses: subosito/flutter-action@v2
-   with:
-     channel: 'stable'
+ - name: "Install Flutter"
+   run: ./.github/workflows/scripts/install-flutter.sh stable
```
ä»¥ä¸Š

# è£œè¶³
è§£èª¬ãªã©

## æ—©ã„ç†ç”±
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯--depth 1ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æœ€æ–°ã®ã‚³ãƒŸãƒƒãƒˆã ã‘å–å¾—ã—ã¦ã„ã‚‹ã®ã§æ—©ã„ã‚ˆã†ã§ã™ã€‚

# ä»»æ„ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Flutterã‚’ä½¿ã„ãŸã„å ´åˆ
-b ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ãƒ–ãƒ©ãƒ³ãƒåã¨ã‚¿ã‚°ã‚’æŒ‡å®šã§ãã‚‹ã®ã§ã€stableã®ã¨ã“ã‚ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ç½®ãæ›ãˆã‚Œã°è‰¯ã„ã§ã™ã€‚
```diff:.github/workflows/hoge.yaml
-        run: ./.github/workflows/scripts/install-flutter.sh stable
+        run: ./.github/workflows/scripts/install-flutter.sh 2.10.1
```
https://github.com/flutter/flutter/tags
# ãƒªãƒã‚¸ãƒˆãƒªå†…ã§Flutterãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ1ã¤ã®å ´åˆ
å°å…¥æ–¹æ³•ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ãƒ–ãƒ©ãƒ³ãƒã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã¾ã™ãŒã€ãƒªãƒã‚¸ãƒˆãƒªå†…ã§ Flutterãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã‚‰ãªã„ãªã‚‰ç›´æŒ‡å®šã—ã¦ã—ã¾ã£ãŸæ–¹ãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰ãˆã‚‹æ™‚ã®ä¿®æ­£ãŒå°‘ãªãã¦æ¥½ã‹ã¨æ€ã„ã¾ã™ã€‚
```bash:.github/workflows/scripts/install-flutter.sh
#!/bin/bash

git clone https://github.com/flutter/flutter.git --depth 1 -b 2.10.1 "$GITHUB_WORKSPACE/_flutter"
echo "$GITHUB_WORKSPACE/_flutter/bin" >> $GITHUB_PATH
```


# ã¾ã¨ã‚
Github Actionsã®ã§Flutterã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é«˜é€ŸåŒ–ã™ã‚‹æ–¹æ³•ã§ã—ãŸã€‚Analyzeã‚„Testã®workflowã‚’pushã”ã¨ã«å›ã—ã¦ã„ã‚‹å ´åˆã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒé€Ÿããªã‚‹ã®ã¯åœ°å‘³ã«ã‚ã‚ŠãŒãŸã„ã§ã™ã­ã€‚

# ãŠã¾ã‘ï¼ˆasdfã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¦ã„ã‚‹å ´åˆï¼‰
import-asdf-tool-versions-actionã‚’ä½¿ã†ã“ã¨ã§.tool-versionsã‹ã‚‰Flutterãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—ã§ãã¾ã™ã€‚analyzeã®actionãªã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã¾ã™ã€‚

```yaml:.github/workflows/flutter_analyze.yml
name: Flutter Analyze

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  flutter-analyze:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: wasabeef/import-asdf-tool-versions-action@v1.0.1
        id: asdf
      - name: "Install Flutter"
        run: ./.github/workflows/scripts/install-flutter.sh ${{ steps.asdf.outputs.flutter }}
      - run: flutter pub get
      - uses: invertase/github-action-dart-analyzer@v1
        with:
          fatal-infos: true
          fatal-warnings: true
          annotate: true
          annotate-only: false
          working-directory: ./lib/
```

Flutterãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°ã—ãŸæ™‚workflowã®æ›´æ–°ã‚‚ã‚ŒãŒãªããªã£ã¦è‰¯ã„ã§ã™ã­ğŸ¥³

https://github.com/wasabeef/import-asdf-tool-versions-action