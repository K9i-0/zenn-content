---
title: "go_router_builder 3.0.0ã®ç ´å£Šçš„å¤‰æ›´ã«ã¤ã„ã¦"
emoji: "ğŸ™"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Flutter", "Dart", "go_router", "go_router_builder"]
published: false
---

# go_router_builder 3.0.0ã®ç ´å£Šçš„å¤‰æ›´ã«ã¤ã„ã¦

go_router_builderãŒ3.0.0ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã¦ã€ç ´å£Šçš„å¤‰æ›´ãŒå…¥ã‚Šã¾ã—ãŸã€‚
æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§go_router_builderã‚’ä½¿ã£ã¦ã‚‹äººã¯å¯¾å¿œãŒå¿…è¦ã§ã™ã€‚

å¤‰æ›´å†…å®¹ã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ–¹æ³•ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

## ä½•ãŒå¤‰ã‚ã£ãŸã‹

### Route classes now required to use a mixin `with _$RouteName`

ä¸€ç•ªå¤§ããªå¤‰æ›´ã¯ã€**ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã§mixinã®ä½¿ç”¨ãŒå¿…é ˆ**ã«ãªã£ãŸã“ã¨ã§ã™ã€‚

#### å¤‰æ›´å‰ï¼ˆ2.x.xï¼‰

```dart:routes.dart
@TypedGoRoute<HomeRoute>(path: '/')
class HomeRoute extends GoRouteData {
  const HomeRoute();

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return const HomeScreen();
  }
}
```

#### å¤‰æ›´å¾Œï¼ˆ3.0.0ï¼‰

```dart:routes.dart
@TypedGoRoute<HomeRoute>(path: '/')
class HomeRoute extends GoRouteData with _$HomeRoute {
  const HomeRoute();

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return const HomeScreen();
  }
}
```

## ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ‰‹é †

### 1. pubspec.yamlã®æ›´æ–°

ã¾ãšã€go_router_builderã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’3.0.0ã«æ›´æ–°ã—ã¾ã™ã€‚

```yaml:pubspec.yaml
dev_dependencies:
  go_router_builder: ^3.0.0
  build_runner: ^2.0.0
```

### 2. ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã®ä¿®æ­£

å…¨ã¦ã®ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã«é©åˆ‡ãªmixinã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

```dart:routes.dart
// HomeRoute
@TypedGoRoute<HomeRoute>(path: '/')
class HomeRoute extends GoRouteData with _$HomeRoute {
  // ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰
}

// å­ãƒ«ãƒ¼ãƒˆã®ä¾‹
@TypedGoRoute<ProductDetailRoute>(path: '/product/:id')
class ProductDetailRoute extends GoRouteData with _$ProductDetailRoute {
  final String id;
  
  const ProductDetailRoute({required this.id});

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return ProductDetailScreen(productId: id);
  }
}

// ShellRouteã®ä¾‹
class MainShellRoute extends ShellRouteData with _$MainShellRoute {
  const MainShellRoute();

  @override
  Widget builder(BuildContext context, GoRouterState state, Widget navigator) {
    return MainShell(child: navigator);
  }
}
```

### 3. ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®å®Ÿè¡Œ

ä¿®æ­£å¾Œã€ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
dart run build_runner build --delete-conflicting-outputs
```

## å®Ÿéš›ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¾‹

### ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ«ãƒ¼ãƒˆ

```dart:routes.dart
// å¤‰æ›´å‰
@TypedGoRoute<LoginRoute>(path: '/login')
class LoginRoute extends GoRouteData {
  final String? redirectPath;
  
  const LoginRoute({this.redirectPath});

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return LoginScreen(redirectPath: redirectPath);
  }
}

// å¤‰æ›´å¾Œ
@TypedGoRoute<LoginRoute>(path: '/login')
class LoginRoute extends GoRouteData with _$LoginRoute {
  final String? redirectPath;
  
  const LoginRoute({this.redirectPath});

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return LoginScreen(redirectPath: redirectPath);
  }
}
```

### è¤‡é›‘ãªãƒ«ãƒ¼ãƒˆï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆä»˜ãï¼‰

```dart:routes.dart
// å¤‰æ›´å‰
@TypedGoRoute<ProfileRoute>(path: '/profile')
class ProfileRoute extends GoRouteData {
  const ProfileRoute();

  @override
  String? redirect(BuildContext context, GoRouterState state) {
    final authState = AuthProvider.of(context);
    if (!authState.isLoggedIn) {
      return const LoginRoute().location;
    }
    return null;
  }

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return const ProfileScreen();
  }
}

// å¤‰æ›´å¾Œ
@TypedGoRoute<ProfileRoute>(path: '/profile')
class ProfileRoute extends GoRouteData with _$ProfileRoute {
  const ProfileRoute();

  @override
  String? redirect(BuildContext context, GoRouterState state) {
    final authState = AuthProvider.of(context);
    if (!authState.isLoggedIn) {
      return const LoginRoute().location;
    }
    return null;
  }

  @override
  Widget build(BuildContext context, GoRouterState state) {
    return const ProfileScreen();
  }
}
```

## åŠ¹ç‡çš„ã«ã‚„ã‚‹æ–¹æ³•

### ä¸€æ‹¬ç½®æ›ã‚’ä½¿ã†

å¤§è¦æ¨¡ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã‚‰ã€ã‚¨ãƒ‡ã‚£ã‚¿ã®ä¸€æ‹¬ç½®æ›ãŒä¾¿åˆ©ã§ã™ã€‚

**æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼š**
```
class (\w+Route) extends GoRouteData \{
```

**ç½®æ›ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼š**
```
class $1 extends GoRouteData with _$$1 {
```

### VSCodeã®å ´åˆ

1. `Cmd/Ctrl + Shift + H`ã§ç½®æ›ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã
2. æ­£è¦è¡¨ç¾ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹ï¼ˆ`.*`ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
3. ä¸Šè¨˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä¸€æ‹¬ç½®æ›

## ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«

### ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚¨ãƒ©ãƒ¼

```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
[SEVERE] go_router_builder on lib/routes.dart:
Missing mixin _$HomeRoute on HomeRoute
```

è©²å½“ã®ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã«`with _$RouteName`ã‚’è¿½åŠ ã—å¿˜ã‚Œã¦ã¾ã™ã€‚

### æ—¢å­˜ã®ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã®ç«¶åˆ

```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
[WARNING] Conflicting outputs were detected
```

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ä¸€åº¦ã‚¯ãƒªãƒ¼ãƒ³ã—ã¦ã‹ã‚‰å†ç”Ÿæˆã—ã¾ã—ã‚‡ã†ã€‚
```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
dart run build_runner clean
dart run build_runner build
```

### å‹ã‚¨ãƒ©ãƒ¼

```bash:ã‚¿ãƒ¼ãƒŸãƒŠãƒ«
The mixin '_$HomeRoute' can't be mixed in because it's missing...
```

- `part`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ãŒæ­£ã—ãè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- ã‚³ãƒ¼ãƒ‰ç”ŸæˆãŒæ­£å¸¸ã«å®Œäº†ã—ã¦ã„ã‚‹ã‹ç¢ºèª

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] pubspec.yamlã§go_router_builderã‚’3.0.0ã«æ›´æ–°
- [ ] å…¨ã¦ã®GoRouteDataç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã«é©åˆ‡ãªmixinã‚’è¿½åŠ 
- [ ] å…¨ã¦ã®ShellRouteDataç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã«é©åˆ‡ãªmixinã‚’è¿½åŠ 
- [ ] ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’å®Ÿè¡Œï¼ˆ`dart run build_runner build`ï¼‰
- [ ] ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª
- [ ] ãƒ†ã‚¹ãƒˆãŒæ­£å¸¸ã«é€šã‚‹ã“ã¨ã‚’ç¢ºèª

## ã¾ã¨ã‚

go_router_builder 3.0.0ã§ã¯ã€ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã§ã®mixinä½¿ç”¨ãŒå¿…é ˆã«ãªã‚Šã¾ã—ãŸã€‚
å¤‰æ›´è‡ªä½“ã¯å˜ç´”ã§ã™ãŒã€æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯å…¨ã¦ã®ãƒ«ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã®ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚

ãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šï¼š
- å…¨ã¦ã®GoRouteDataã‚¯ãƒ©ã‚¹ã«`with _$ClassName`ã‚’è¿½åŠ 
- ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®å†å®Ÿè¡ŒãŒå¿…é ˆ
- ä¸€æ‹¬ç½®æ›ã§åŠ¹ç‡çš„ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯èƒ½

ã“ã®å¤‰æ›´ã§å‹å®‰å…¨æ€§ãŒå‘ä¸Šã—ã€ã‚ˆã‚Šç¢ºå®Ÿãªã‚³ãƒ¼ãƒ‰ç”ŸæˆãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
æ—©ã‚ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ãŠãã®ãŒãŠã™ã™ã‚ã§ã™ğŸ‘

### å‚è€ƒãƒªãƒ³ã‚¯

- [go_router_builder 3.0.0 Changelog](https://pub.dev/packages/go_router_builder/changelog)
- [go_routerå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://pub.dev/packages/go_router)
- [Flutterå…¬å¼: Type-safe routing](https://docs.flutter.dev/ui/navigation/go-router)
